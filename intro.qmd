# 导论：一张图的诞生 {#sec-intro}

::: {.callout-tip}
## B站视频
本章对应视频：[EP01 导论：为什么单细胞可视化值得认真学？](https://bilibili.com/xxx)
:::

## 从10000个细胞说起

假设你刚刚完成了一个单细胞RNA测序实验，测了10000个细胞，每个细胞检测了20000个基因。

你手上有一个 **10000 × 20000 = 2亿维** 的数据矩阵。

人类大脑无法理解2亿维空间中的任何东西。但如果我告诉你，这一万个细胞其实就分成5种类型，你马上就能理解了。

**单细胞可视化的本质，就是把高维数据"压缩"成人脑能理解的二维图形，同时尽可能保留生物学信息。**

这个过程中，每一步选择都至关重要：

- 用PCA还是UMAP？
- 参数怎么设？
- 颜色怎么配？
- 图例放哪里？

这些看似"小事"，往往决定了你的图是Nature级别还是PPT级别。

## 什么是"科研品味"？

我把科研可视化的品味分为三个层次：

### 第一层：技术正确

图表没有明显的技术错误：

- 坐标轴有标签
- 图例能看懂
- 数据没有明显的处理错误

大多数人停留在这一层。

### 第二层：信息高效

图表能高效传达信息：

- 选择了最合适的图表类型
- 去除了所有不必要的元素
- 读者能快速理解核心信息

这需要对每种图表类型有深入理解。

### 第三层：审美优雅

图表在美学上令人愉悦：

- 配色和谐
- 比例协调
- 细节精致

这是Nature、Cell文章的标准。

## 本书的核心框架

对于每一种可视化方法，我们都会从三个问题出发：

::: {.panel-tabset}

### 为什么选它？

- 这种图能回答什么生物学问题？
- 什么时候**不该**用它？
- 审稿人/读者期待看到什么？

### 怎样画对？

- 数据预处理的陷阱
- 参数选择的依据
- 常见错误示范

### 怎样画美？

- 配色的科学与艺术
- 布局与留白
- 字体、比例、分辨率

:::

## 我们会学到什么？

```{mermaid}
%%| fig-cap: "本书内容概览"
flowchart LR
    A[原始数据] --> B[降维]
    B --> C[UMAP/t-SNE]
    A --> D[表达量]
    D --> E[Dotplot/Heatmap]
    A --> F[轨迹]
    F --> G[Monocle/Velocity]
    A --> H[通讯]
    H --> I[CellChat/COMMOT]
```

| 部分 | 内容 | 核心问题 |
|------|------|----------|
| 第一部分 | 降维与散点图 | 如何把高维数据压缩到二维？ |
| 第二部分 | 表达量可视化 | 如何展示基因表达模式？ |
| 第三部分 | 轨迹与动态 | 如何展示细胞分化过程？ |
| 第四部分 | 细胞通讯 | 如何展示细胞间的相互作用？ |

## 环境准备

本书使用R语言，主要依赖以下包：

```{r}
#| label: setup
#| eval: false

# 核心分析包
install.packages("Seurat")
install.packages("ggplot2")
install.packages("dplyr")

# 轨迹分析
BiocManager::install("monocle3")

# 细胞通讯
devtools::install_github("sqjin/CellChat")

# 配色
install.packages("RColorBrewer")
install.packages("viridis")
install.packages("ggsci")
```

## 示例数据

本书使用的示例数据来自人类胚胎空间转录组项目（Carnegie Stage 9-10）。

```{r}
#| label: load-data
#| eval: false

# 加载示例数据
# 数据将随书发布在GitHub
sobj <- readRDS("data/CS9_example.rds")
```

---

**下一章：** [PCA：降维的起点](part1-dimred/ch01-pca.qmd)
